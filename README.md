# High-performance-coding
# 高性能编码

### 1.采用静态数据结构

   对于简单的数据类型，尽量采用静态的数据结构来表达，系统访问静态数据结构比非静态大约快15%～20％。
   如果是常量，建议使用final

    static int a =1;

### 2.循环中不要使用复杂表达式

   循环条件会被反复计算，导致性能变差

    for(int i=0;i＜arry.length;i++) 将arry.length 提成成员变量

### 3.移位操作代替乘除

   2倍数的乘除操作，可以使用移位来完成，提升性能。

    size/1024       size＞＞10

### 4.合理设置组建状态

   当某个组件暂时不需要被使用，但又不想直接销毁该组件，可以动态设置组件的状态来完成此目的。

    PackageManagerService   setComponentEnableSetting


### 5.主动停止长时间空闲的服务

   长时间空闲的服务将使所在进程一直处在 Services(oom_adj =8),进程不容易被杀掉，内存也较难及时让出。
   因此，我们建议这类服务在处理完请求后调用Service.StopSelft()将服务停止，让进程的oom_adj 降到Background


### 6.重要的应用可以适当的调整oom_adj的级别，降低被杀的概率

   相关代码AMS startProcessLocked

### 7.谨慎使用foreach

   PreferForinArrayList/ArrayList 的遍历应采用for循环。
   如果循环对象为arraylist，foreach和Iterator方式在循环过程中会进行数据锁定，导致性能稍微差(时间消耗)
    对于循环体已经实现了Iterator接口或者使用Array数据类型，建议使用增加循环语法结构

8.尽量使用库函数

大部分库函数都是人工优化编译的汇编程序，这些代码的效率远高于JIT(just in time)自动编译产生的代码

9.避免集合类的自动增长

集合类的构造器会创建一个默认的容量大小，在使用中，如果超过这个大小，就会重新分配内存，重构一个更大容量的对象，并且将原先的数据复制过来，再丢弃旧的数据，这样会浪费很多时间。在大多数情况下，可以在创建对象的时候指定大小，或者估计出所需要的最佳大小，这样就避免了在容量不够的时候自动增长，以提高性能。

10.尽量使用final修饰符

带有final修饰符的类是不可派生的。如果一个类是final的，则该类所有方法都是final的。java编译器会寻找机会内联(inline)所有的final方法。此举能够使性能平均提高50%

11.尽量使用基本数据类型代替对象

使用对象会有额外的内存开销

创建一个字符串，而且jvm的字符缓存池还会缓存这个字符串。

此时程序除了会创建一个“hello”字符串外，str所引用的string对象底层还包括一个char[]数组

12.尽可能避免使用内在的get/set方法

android编程中，虚方法的调用会产生很多代价，比实例属性查询的代价还要多。我们应该在外部调用的时候才使用get，set方法，在内部应该直接调用。













